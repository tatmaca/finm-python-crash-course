
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.5 Factor Analysis on Financial and Economic Time Series &#8212; FINM August Review: Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=e1a75a79"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_notebook_build/_03_factor_analysis_demo';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.6 Introduction to WRDS" href="../WRDS_intro_and_web_queries.html" />
    <link rel="prev" title="3.4 Handling Missing Data" href="_03_04-Missing-Values.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="FINM August Review: Python - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="FINM August Review: Python - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    FINM August Review: Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Discussion 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../discussion_01.html">1. Agenda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_setting_up_environment.html">1.1 Setting up your computing environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_methods_for_using_python.html">1.2 Ways to Interact with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../HW1.html">Homework 1: Introduction to VS Code and Git</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Discussion 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../discussion_02.html">2. Agenda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../syncing_files_with_git_and_github.html">2.1 Syncing Files with Git and GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="_02_overview_of_pydata_stack.html">2.2 Overview of the PyData Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="_02_comparing_plotting_libraries.html">2.3 Comparing Plotting Libraries and Declarative Visualizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="_02_Using_Interact.html">2.4 Using Interact (Optional)</a></li>
<li class="toctree-l1"><a class="reference internal" href="_02_python_by_example.html">2.5 Python Basics: An Introductory Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="_HW2-numpy-scipy.html">Homework 2: Numpy, Scipy, and Matplotlib</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Discussion 3</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../discussion_03.html">3. Agenda</a></li>
<li class="toctree-l1"><a class="reference internal" href="_03_01-Introducing-Pandas-Objects.html">3.1 Introducing Pandas Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="_03_02-Data-Indexing-and-Selection.html">3.2 Data Indexing and Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="_03_03-Operations-in-Pandas.html">3.3 Operating on Data in Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="_03_04-Missing-Values.html">3.4 Handling Missing Data</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">3.5 Factor Analysis on Financial and Economic Time Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WRDS_intro_and_web_queries.html">3.6 Introduction to WRDS</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Discussion 4Ô∏è</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../discussion_04.html">4. Agenda</a></li>
<li class="toctree-l1"><a class="reference internal" href="_04_wrds_python_package.html">4.2 Connecting to the WRDS Platform With Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="_04_CRSP_market_index.html">4.3 CRSP Market Returns Indices</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../myst_markdown_demos.html">MyST Markdown Demos üí°</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apidocs/index.html">API Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../apidocs/misc_tools/misc_tools.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">misc_tools</span></code></a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jmbejara/finm-python-crash-course" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jmbejara/finm-python-crash-course/issues/new?title=Issue%20on%20page%20%2F_notebook_build/_03_factor_analysis_demo.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/_notebook_build/_03_factor_analysis_demo.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>3.5 Factor Analysis on Financial and Economic Time Series</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-macroeconomic-and-financial-data-from-fred">Downloading macroeconomic and financial data from FRED</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cleaning-data">Cleaning Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transforming-and-normalizing-the-data">Transforming and Normalizing the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factor-analysis-of-a-panel-of-stock-returns">Factor Analysis of a Panel of Stock Returns?</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="factor-analysis-on-financial-and-economic-time-series">
<h1>3.5 Factor Analysis on Financial and Economic Time Series<a class="headerlink" href="#factor-analysis-on-financial-and-economic-time-series" title="Link to this heading">#</a></h1>
<p>Factor Analysis and Principal Component Analysis on Financial and Economic Time Series</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># If you&#39;re running this on Colab, make sure to install the following packages using pip.</span>
<span class="c1"># On you&#39;re own computer, I recommend using conda or mamba.</span>

<span class="c1"># !pip install pandas-datareader</span>
<span class="c1"># !pip install yfinance</span>

<span class="c1"># !conda install pandas-datareader</span>
<span class="c1"># !conda install yfinance</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="kn">import</span> <span class="nn">yfinance</span> <span class="k">as</span> <span class="nn">yf</span>
<span class="kn">import</span> <span class="nn">pandas_datareader</span> <span class="k">as</span> <span class="nn">pdr</span>
<span class="kn">import</span> <span class="nn">sklearn.decomposition</span>
<span class="kn">import</span> <span class="nn">statsmodels.multivariate.pca</span>
</pre></div>
</div>
</div>
</div>
<section id="downloading-macroeconomic-and-financial-data-from-fred">
<h2>Downloading macroeconomic and financial data from FRED<a class="headerlink" href="#downloading-macroeconomic-and-financial-data-from-fred" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fred_series_long_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;BAMLH0A0HYM2&#39;</span><span class="p">:</span> <span class="s1">&#39;ICE BofA US High Yield Index Option-Adjusted Spread&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NASDAQCOM&#39;</span><span class="p">:</span> <span class="s1">&#39;NASDAQ Composite Index&#39;</span><span class="p">,</span>
    <span class="s1">&#39;RIFSPPFAAD90NB&#39;</span><span class="p">:</span> <span class="s1">&#39;90-Day AA Financial Commercial Paper Interest Rate&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TB3MS&#39;</span><span class="p">:</span> <span class="s1">&#39;3-Month Treasury Bill Secondary Market Rate&#39;</span><span class="p">,</span>
    <span class="s1">&#39;DGS10&#39;</span><span class="p">:</span> <span class="s1">&#39;Market Yield on U.S. Treasury Securities at 10-Year Constant Maturity&#39;</span><span class="p">,</span>
    <span class="s1">&#39;VIXCLS&#39;</span><span class="p">:</span> <span class="s1">&#39;CBOE Volatility Index: VIX&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fred_series_short_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;BAMLH0A0HYM2&#39;</span><span class="p">:</span> <span class="s1">&#39;High Yield Index OAS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NASDAQCOM&#39;</span><span class="p">:</span> <span class="s1">&#39;NASDAQ&#39;</span><span class="p">,</span>
    <span class="s1">&#39;RIFSPPFAAD90NB&#39;</span><span class="p">:</span> <span class="s1">&#39;90-Day AA Fin CP&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TB3MS&#39;</span><span class="p">:</span> <span class="s1">&#39;3-Month T-Bill&#39;</span><span class="p">,</span>
    <span class="s1">&#39;DGS10&#39;</span><span class="p">:</span> <span class="s1">&#39;10-Year Treasury&#39;</span><span class="p">,</span>
    <span class="s1">&#39;VIXCLS&#39;</span><span class="p">:</span> <span class="s1">&#39;VIX&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">start_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;1980-01-01&#39;</span><span class="p">)</span> 
<span class="n">end_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;today&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_fred</span><span class="p">(</span><span class="n">fred_series_short_names</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">start</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end_date</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>First, an aside about reading and writing data to disk.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;fred_panel.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dff</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;fred_panel.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dff</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 11877 entries, 0 to 11876
Data columns (total 7 columns):
 #   Column          Non-Null Count  Dtype  
---  ------          --------------  -----  
 0   DATE            11877 non-null  object 
 1   BAMLH0A0HYM2    7202 non-null   float64
 2   NASDAQCOM       11241 non-null  float64
 3   RIFSPPFAAD90NB  6467 non-null   float64
 4   TB3MS           535 non-null    float64
 5   DGS10           11147 non-null  float64
 6   VIXCLS          8727 non-null   float64
dtypes: float64(6), object(1)
memory usage: 649.7+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dff</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;fred_panel.csv&#39;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DATE&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dff</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 11877 entries, 0 to 11876
Data columns (total 7 columns):
 #   Column          Non-Null Count  Dtype         
---  ------          --------------  -----         
 0   DATE            11877 non-null  datetime64[ns]
 1   BAMLH0A0HYM2    7202 non-null   float64       
 2   NASDAQCOM       11241 non-null  float64       
 3   RIFSPPFAAD90NB  6467 non-null   float64       
 4   TB3MS           535 non-null    float64       
 5   DGS10           11147 non-null  float64       
 6   VIXCLS          8727 non-null   float64       
dtypes: datetime64[ns](1), float64(6)
memory usage: 649.7 KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dff</span> <span class="o">=</span> <span class="n">dff</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;DATE&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s1">&#39;fred_panel.parquet&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s1">&#39;fred_panel.parquet&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 11877 entries, 1980-01-01 to 2024-08-01
Data columns (total 6 columns):
 #   Column          Non-Null Count  Dtype  
---  ------          --------------  -----  
 0   BAMLH0A0HYM2    7202 non-null   float64
 1   NASDAQCOM       11241 non-null  float64
 2   RIFSPPFAAD90NB  6467 non-null   float64
 3   TB3MS           535 non-null    float64
 4   DGS10           11147 non-null  float64
 5   VIXCLS          8727 non-null   float64
dtypes: float64(6)
memory usage: 649.5 KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BAMLH0A0HYM2</th>
      <th>NASDAQCOM</th>
      <th>RIFSPPFAAD90NB</th>
      <th>TB3MS</th>
      <th>DGS10</th>
      <th>VIXCLS</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1980-01-01</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980-01-02</th>
      <td>NaN</td>
      <td>148.17</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10.50</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980-01-03</th>
      <td>NaN</td>
      <td>145.97</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10.60</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980-01-04</th>
      <td>NaN</td>
      <td>148.02</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10.66</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980-01-07</th>
      <td>NaN</td>
      <td>148.62</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10.63</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2024-07-26</th>
      <td>3.10</td>
      <td>17357.88</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.20</td>
      <td>16.39</td>
    </tr>
    <tr>
      <th>2024-07-29</th>
      <td>3.13</td>
      <td>17370.20</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.17</td>
      <td>16.60</td>
    </tr>
    <tr>
      <th>2024-07-30</th>
      <td>3.20</td>
      <td>17147.42</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.15</td>
      <td>17.69</td>
    </tr>
    <tr>
      <th>2024-07-31</th>
      <td>3.25</td>
      <td>17599.40</td>
      <td>5.30</td>
      <td>NaN</td>
      <td>4.09</td>
      <td>16.36</td>
    </tr>
    <tr>
      <th>2024-08-01</th>
      <td>3.35</td>
      <td>17194.15</td>
      <td>5.19</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.59</td>
    </tr>
  </tbody>
</table>
<p>11877 rows √ó 6 columns</p>
</div></div></div>
</div>
</section>
<section id="cleaning-data">
<h2>Cleaning Data<a class="headerlink" href="#cleaning-data" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">dff</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">fred_series_short_names</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>High Yield Index OAS</th>
      <th>NASDAQ</th>
      <th>90-Day AA Fin CP</th>
      <th>3-Month T-Bill</th>
      <th>10-Year Treasury</th>
      <th>VIX</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1980-01-01</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980-01-02</th>
      <td>NaN</td>
      <td>148.17</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10.50</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980-01-03</th>
      <td>NaN</td>
      <td>145.97</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10.60</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980-01-04</th>
      <td>NaN</td>
      <td>148.02</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10.66</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980-01-07</th>
      <td>NaN</td>
      <td>148.62</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10.63</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2024-07-26</th>
      <td>3.10</td>
      <td>17357.88</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.20</td>
      <td>16.39</td>
    </tr>
    <tr>
      <th>2024-07-29</th>
      <td>3.13</td>
      <td>17370.20</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.17</td>
      <td>16.60</td>
    </tr>
    <tr>
      <th>2024-07-30</th>
      <td>3.20</td>
      <td>17147.42</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.15</td>
      <td>17.69</td>
    </tr>
    <tr>
      <th>2024-07-31</th>
      <td>3.25</td>
      <td>17599.40</td>
      <td>5.30</td>
      <td>NaN</td>
      <td>4.09</td>
      <td>16.36</td>
    </tr>
    <tr>
      <th>2024-08-01</th>
      <td>3.35</td>
      <td>17194.15</td>
      <td>5.19</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.59</td>
    </tr>
  </tbody>
</table>
<p>11877 rows √ó 6 columns</p>
</div></div></div>
</div>
<p>Balanced panel? Mixed frequencies?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;3-Month T-Bill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DATE
1980-01-01    12.00
1980-02-01    12.86
1980-03-01    15.20
1980-04-01    13.20
1980-05-01     8.58
              ...  
2024-03-01     5.24
2024-04-01     5.24
2024-05-01     5.25
2024-06-01     5.24
2024-07-01     5.20
Name: 3-Month T-Bill, Length: 535, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Find a daily version of this series. See here: <a class="reference external" href="https://fred.stlouisfed.org/categories/22">https://fred.stlouisfed.org/categories/22</a></p>
<p>We will end up using this series: <a class="reference external" href="https://fred.stlouisfed.org/series/DTB3">https://fred.stlouisfed.org/series/DTB3</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fred_series_short_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;BAMLH0A0HYM2&#39;</span><span class="p">:</span> <span class="s1">&#39;High Yield Index OAS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NASDAQCOM&#39;</span><span class="p">:</span> <span class="s1">&#39;NASDAQ&#39;</span><span class="p">,</span>
    <span class="s1">&#39;RIFSPPFAAD90NB&#39;</span><span class="p">:</span> <span class="s1">&#39;90-Day AA Fin CP&#39;</span><span class="p">,</span>
    <span class="s1">&#39;DTB3&#39;</span><span class="p">:</span> <span class="s1">&#39;3-Month T-Bill&#39;</span><span class="p">,</span>
    <span class="s1">&#39;DGS10&#39;</span><span class="p">:</span> <span class="s1">&#39;10-Year Treasury&#39;</span><span class="p">,</span>
    <span class="s1">&#39;VIXCLS&#39;</span><span class="p">:</span> <span class="s1">&#39;VIX&#39;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_data_fred</span><span class="p">(</span><span class="n">fred_series_short_names</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">start</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end_date</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">fred_series_short_names</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>High Yield Index OAS</th>
      <th>NASDAQ</th>
      <th>90-Day AA Fin CP</th>
      <th>3-Month T-Bill</th>
      <th>10-Year Treasury</th>
      <th>VIX</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1980-01-01</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980-01-02</th>
      <td>NaN</td>
      <td>148.17</td>
      <td>NaN</td>
      <td>12.17</td>
      <td>10.50</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980-01-03</th>
      <td>NaN</td>
      <td>145.97</td>
      <td>NaN</td>
      <td>12.10</td>
      <td>10.60</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980-01-04</th>
      <td>NaN</td>
      <td>148.02</td>
      <td>NaN</td>
      <td>12.10</td>
      <td>10.66</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980-01-07</th>
      <td>NaN</td>
      <td>148.62</td>
      <td>NaN</td>
      <td>11.86</td>
      <td>10.63</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2024-07-26</th>
      <td>3.10</td>
      <td>17357.88</td>
      <td>NaN</td>
      <td>5.16</td>
      <td>4.20</td>
      <td>16.39</td>
    </tr>
    <tr>
      <th>2024-07-29</th>
      <td>3.13</td>
      <td>17370.20</td>
      <td>NaN</td>
      <td>5.15</td>
      <td>4.17</td>
      <td>16.60</td>
    </tr>
    <tr>
      <th>2024-07-30</th>
      <td>3.20</td>
      <td>17147.42</td>
      <td>NaN</td>
      <td>5.14</td>
      <td>4.15</td>
      <td>17.69</td>
    </tr>
    <tr>
      <th>2024-07-31</th>
      <td>3.25</td>
      <td>17599.40</td>
      <td>5.30</td>
      <td>5.15</td>
      <td>4.09</td>
      <td>16.36</td>
    </tr>
    <tr>
      <th>2024-08-01</th>
      <td>3.35</td>
      <td>17194.15</td>
      <td>5.19</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>18.59</td>
    </tr>
  </tbody>
</table>
<p>11726 rows √ó 6 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>High Yield Index OAS</th>
      <th>NASDAQ</th>
      <th>90-Day AA Fin CP</th>
      <th>3-Month T-Bill</th>
      <th>10-Year Treasury</th>
      <th>VIX</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1997-01-02</th>
      <td>3.06</td>
      <td>1280.70</td>
      <td>5.35</td>
      <td>5.05</td>
      <td>6.54</td>
      <td>21.14</td>
    </tr>
    <tr>
      <th>1997-01-03</th>
      <td>3.09</td>
      <td>1310.68</td>
      <td>5.35</td>
      <td>5.04</td>
      <td>6.52</td>
      <td>19.13</td>
    </tr>
    <tr>
      <th>1997-01-06</th>
      <td>3.10</td>
      <td>1316.40</td>
      <td>5.34</td>
      <td>5.05</td>
      <td>6.54</td>
      <td>19.89</td>
    </tr>
    <tr>
      <th>1997-01-07</th>
      <td>3.10</td>
      <td>1327.73</td>
      <td>5.33</td>
      <td>5.02</td>
      <td>6.57</td>
      <td>19.35</td>
    </tr>
    <tr>
      <th>1997-01-08</th>
      <td>3.07</td>
      <td>1320.35</td>
      <td>5.31</td>
      <td>5.02</td>
      <td>6.60</td>
      <td>20.24</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2024-07-11</th>
      <td>3.18</td>
      <td>18283.41</td>
      <td>5.25</td>
      <td>5.21</td>
      <td>4.20</td>
      <td>12.92</td>
    </tr>
    <tr>
      <th>2024-07-12</th>
      <td>3.19</td>
      <td>18398.45</td>
      <td>5.35</td>
      <td>5.21</td>
      <td>4.18</td>
      <td>12.46</td>
    </tr>
    <tr>
      <th>2024-07-22</th>
      <td>3.05</td>
      <td>18007.57</td>
      <td>5.29</td>
      <td>5.19</td>
      <td>4.26</td>
      <td>14.91</td>
    </tr>
    <tr>
      <th>2024-07-25</th>
      <td>3.08</td>
      <td>17181.72</td>
      <td>5.32</td>
      <td>5.17</td>
      <td>4.27</td>
      <td>18.46</td>
    </tr>
    <tr>
      <th>2024-07-31</th>
      <td>3.25</td>
      <td>17599.40</td>
      <td>5.30</td>
      <td>5.15</td>
      <td>4.09</td>
      <td>16.36</td>
    </tr>
  </tbody>
</table>
<p>6447 rows √ó 6 columns</p>
</div></div></div>
</div>
</section>
<section id="transforming-and-normalizing-the-data">
<h2>Transforming and Normalizing the data<a class="headerlink" href="#transforming-and-normalizing-the-data" title="Link to this heading">#</a></h2>
<p>What is transformation and normalization? Are these different things?</p>
<ul class="simple">
<li><p>Why would one transform data? What is feature engineering?</p></li>
<li><p>What is normalization?</p></li>
</ul>
<p>What does stationarity mean? See the the following plots. Some of these variable are stationary. Other are not? Why is this a problem?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;DATE&#39;&gt;
</pre></div>
</div>
<img alt="../_images/2d70ca55b1144ed3d7732e71c8d624e6cdf4a762a70f23121cd9001a7a0b971f.png" src="../_images/2d70ca55b1144ed3d7732e71c8d624e6cdf4a762a70f23121cd9001a7a0b971f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 11726 entries, 1980-01-01 to 2024-08-01
Data columns (total 6 columns):
 #   Column                Non-Null Count  Dtype  
---  ------                --------------  -----  
 0   High Yield Index OAS  7202 non-null   float64
 1   NASDAQ                11241 non-null  float64
 2   90-Day AA Fin CP      6467 non-null   float64
 3   3-Month T-Bill        11147 non-null  float64
 4   10-Year Treasury      11147 non-null  float64
 5   VIX                   8727 non-null   float64
dtypes: float64(6)
memory usage: 641.3 KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;NASDAQ&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;DATE&#39;&gt;
</pre></div>
</div>
<img alt="../_images/d9f2c5714918a3f8feece11a2002fe799aedf4218424fc213a45016fdeb5b725.png" src="../_images/d9f2c5714918a3f8feece11a2002fe799aedf4218424fc213a45016fdeb5b725.png" />
</div>
</div>
<p>Let‚Äôs try some transformations like those used in the OFR Financial Stress Index: <a class="reference external" href="https://www.financialresearch.gov/financial-stress-index/files/indicators/index.html">https://www.financialresearch.gov/financial-stress-index/files/indicators/index.html</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfn</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span><span class="o">.</span><span class="n">reindex_like</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">dfn</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>High Yield Index OAS</th>
      <th>NASDAQ</th>
      <th>90-Day AA Fin CP</th>
      <th>3-Month T-Bill</th>
      <th>10-Year Treasury</th>
      <th>VIX</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1980-01-01</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980-01-02</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980-01-03</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980-01-04</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1980-01-07</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2024-07-26</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2024-07-29</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2024-07-30</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2024-07-31</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2024-08-01</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>11726 rows √ó 6 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;NASDAQ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">250</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DATE
1980-01-01   NaN
1980-01-02   NaN
1980-01-03   NaN
1980-01-04   NaN
1980-01-07   NaN
              ..
2024-07-26   NaN
2024-07-29   NaN
2024-07-30   NaN
2024-07-31   NaN
2024-08-01   NaN
Name: NASDAQ, Length: 11726, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;NASDAQ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">250</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DATE
1997-01-02            NaN
1997-01-03            NaN
1997-01-06            NaN
1997-01-07            NaN
1997-01-08            NaN
                 ...     
2024-07-11    13504.37800
2024-07-12    13535.02176
2024-07-22    13564.74956
2024-07-25    13590.21472
2024-07-31    13615.90668
Name: NASDAQ, Length: 6447, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># &#39;High Yield Index OAS&#39;: Leave as is</span>
<span class="n">dfn</span><span class="p">[</span><span class="s1">&#39;High Yield Index OAS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;High Yield Index OAS&#39;</span><span class="p">]</span>
<span class="n">dfn</span><span class="p">[</span><span class="s1">&#39;CP - Treasury Spread, 3m&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;90-Day AA Fin CP&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;10-Year Treasury&#39;</span><span class="p">]</span>
<span class="c1"># &#39;NASDAQ&#39;:  # We&#39;re using something different, but still apply rolling mean transformation</span>
<span class="n">dfn</span><span class="p">[</span><span class="s1">&#39;NASDAQ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;NASDAQ&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;NASDAQ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">250</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">dfn</span><span class="p">[</span><span class="s1">&#39;10-Year Treasury&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;10-Year Treasury&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;10-Year Treasury&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">250</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="c1"># &#39;VIX&#39;: Leave as is</span>
<span class="n">dfn</span><span class="p">[</span><span class="s1">&#39;VIX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;VIX&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfn</span> <span class="o">=</span> <span class="n">dfn</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;90-Day AA Fin CP&#39;</span><span class="p">,</span> <span class="s1">&#39;3-Month T-Bill&#39;</span><span class="p">])</span>
<span class="n">dfn</span> <span class="o">=</span> <span class="n">dfn</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfn</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
DatetimeIndex: 6198 entries, 1998-01-05 to 2024-07-31
Data columns (total 5 columns):
 #   Column                    Non-Null Count  Dtype  
---  ------                    --------------  -----  
 0   High Yield Index OAS      6198 non-null   float64
 1   NASDAQ                    6198 non-null   float64
 2   10-Year Treasury          6198 non-null   float64
 3   VIX                       6198 non-null   float64
 4   CP - Treasury Spread, 3m  6198 non-null   float64
dtypes: float64(5)
memory usage: 290.5 KB
</pre></div>
</div>
</div>
</div>
<p>We finished with our transformations. Now, let‚Äôs normalize. First, why is it important?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfn</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;DATE&#39;&gt;
</pre></div>
</div>
<img alt="../_images/be2d9ea13372b77666e1528ac00e9739a018eda725574149fb3699508827cd3f.png" src="../_images/be2d9ea13372b77666e1528ac00e9739a018eda725574149fb3699508827cd3f.png" />
</div>
</div>
<p>Now, normalize each column,
$<span class="math notranslate nohighlight">\(
z = \frac{x - \bar x}{\text{std}(x)}
\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfn</span> <span class="o">=</span> <span class="p">(</span><span class="n">dfn</span> <span class="o">-</span> <span class="n">dfn</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">dfn</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dfn</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;DATE&#39;&gt;
</pre></div>
</div>
<img alt="../_images/328868a5990bc15b677d2fe7cd09ed4daec9ccbfc110fa837bc4e8f1fb2fe956.png" src="../_images/328868a5990bc15b677d2fe7cd09ed4daec9ccbfc110fa837bc4e8f1fb2fe956.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pca</span><span class="p">(</span><span class="n">dfn</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s1">&#39;scikitlearn&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">module</span> <span class="o">==</span> <span class="s1">&#39;statsmodels&#39;</span><span class="p">:</span>
        <span class="n">_pc1</span><span class="p">,</span> <span class="n">_loadings</span><span class="p">,</span> <span class="n">projection</span><span class="p">,</span> <span class="n">rsquare</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">statsmodels</span><span class="o">.</span><span class="n">multivariate</span><span class="o">.</span><span class="n">pca</span><span class="o">.</span><span class="n">pca</span><span class="p">(</span><span class="n">dfn</span><span class="p">,</span>
            <span class="n">ncomp</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">demean</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">gls</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;svd&#39;</span><span class="p">)</span>
        <span class="n">_loadings</span> <span class="o">=</span> <span class="n">_loadings</span><span class="p">[</span><span class="s1">&#39;comp_0&#39;</span><span class="p">]</span>
        <span class="n">loadings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">_pc1</span><span class="p">)</span> <span class="o">*</span> <span class="n">_loadings</span>
        <span class="n">pc1</span> <span class="o">=</span> <span class="n">_pc1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">_pc1</span><span class="p">)</span>
        <span class="n">pc1</span> <span class="o">=</span> <span class="n">pc1</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;comp_0&#39;</span><span class="p">:</span><span class="s1">&#39;PC1&#39;</span><span class="p">})[</span><span class="s1">&#39;PC1&#39;</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">module</span> <span class="o">==</span> <span class="s1">&#39;scikitlearn&#39;</span><span class="p">:</span>
        <span class="n">pca</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">decomposition</span><span class="o">.</span><span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">_pc1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">dfn</span><span class="p">)[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">dfn</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;PC1&#39;</span><span class="p">)</span>
        <span class="n">_loadings</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">components_</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_</span><span class="p">)</span>
        <span class="n">_loadings</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">_loadings</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">dfn</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

        <span class="n">loadings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">_pc1</span><span class="p">)</span> <span class="o">*</span> <span class="n">_loadings</span>
        <span class="n">pc1</span> <span class="o">=</span> <span class="n">_pc1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">_pc1</span><span class="p">)</span>
        <span class="n">pc1</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;PC1&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span>



    <span class="n">loadings</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;loadings&quot;</span>

    <span class="k">return</span> <span class="n">pc1</span><span class="p">,</span> <span class="n">loadings</span>

<span class="k">def</span> <span class="nf">stacked_plot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    df=category_contributions</span>
<span class="sd">    # category_contributions.sum(axis=1).plot()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">df_pos</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">df_neg</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span>

    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">.3</span>
    <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">.5</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">df_pos</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">area</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">pc1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">pc1</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;pc1&#39;</span>
    <span class="n">pc1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;Black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pc1&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">df_neg</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">area</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="c1"># recompute the ax.dataLim</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">relim</span><span class="p">()</span>
    <span class="c1"># update ax.viewLim using the new dataLim</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">autoscale</span><span class="p">()</span>
    <span class="c1"># ax.set_ylabel(&#39;Standard Deviations&#39;)</span>
    <span class="c1"># ax.set_ylim(-3,4)</span>
    <span class="c1"># ax.set_ylim(-30,30)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">figure</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span> <span class="c1"># get current figure</span>
        <span class="n">figure</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pc1</span><span class="p">,</span> <span class="n">loadings</span> <span class="o">=</span> <span class="n">pca</span><span class="p">(</span><span class="n">dfn</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s1">&#39;scikitlearn&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pc1</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;DATE&#39;&gt;
</pre></div>
</div>
<img alt="../_images/053c65d15991fbdc5cb539f8ca7f42a5acf2ace8edec9371a0510e60a7104f33.png" src="../_images/053c65d15991fbdc5cb539f8ca7f42a5acf2ace8edec9371a0510e60a7104f33.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">stacked_plot</span><span class="p">(</span><span class="n">dfn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7814f803a7d7500f131fd75e2dbb6e5f6a2b02a84877bb3c6aba1764c6e05b30.png" src="../_images/7814f803a7d7500f131fd75e2dbb6e5f6a2b02a84877bb3c6aba1764c6e05b30.png" />
</div>
</div>
<p>Let‚Äôs compare solutions from two different packages</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">root_mean_squared_error</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span> <span class="n">sb</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">sa</span> <span class="o">-</span> <span class="n">sb</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

<span class="n">pc1_sk</span><span class="p">,</span> <span class="n">loadings_sk</span> <span class="o">=</span> <span class="n">pca</span><span class="p">(</span><span class="n">dfn</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s1">&#39;scikitlearn&#39;</span><span class="p">)</span>
<span class="n">pc1_sm</span><span class="p">,</span> <span class="n">loadings_sm</span> <span class="o">=</span> <span class="n">pca</span><span class="p">(</span><span class="n">dfn</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s1">&#39;statsmodels&#39;</span><span class="p">)</span>
<span class="n">root_mean_squared_error</span><span class="p">(</span><span class="n">pc1_sm</span><span class="p">,</span> <span class="n">pc1_sk</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\Jeremy\miniforge3\envs\finm\Lib\site-packages\numpy\core\fromnumeric.py:3643: FutureWarning: The behavior of DataFrame.std with axis=None is deprecated, in a future version this will reduce over both axes and return a scalar. To retain the old behavior, pass axis=0 (or do not pass axis)
  return std(axis=axis, dtype=dtype, out=out, ddof=ddof, **kwargs)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0225687823058228e-16
</pre></div>
</div>
</div>
</div>
</section>
<section id="factor-analysis-of-a-panel-of-stock-returns">
<h2>Factor Analysis of a Panel of Stock Returns?<a class="headerlink" href="#factor-analysis-of-a-panel-of-stock-returns" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;SPY AAPL MSFT&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s2">&quot;2017-01-01&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2017-04-30&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[                       0%%                      ]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************67%%******                ]  2 of 3 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[*********************100%%**********************]  3 of 3 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>Price</th>
      <th colspan="3" halign="left">Adj Close</th>
      <th colspan="3" halign="left">Close</th>
      <th colspan="3" halign="left">High</th>
      <th colspan="3" halign="left">Low</th>
      <th colspan="3" halign="left">Open</th>
      <th colspan="3" halign="left">Volume</th>
    </tr>
    <tr>
      <th>Ticker</th>
      <th>AAPL</th>
      <th>MSFT</th>
      <th>SPY</th>
      <th>AAPL</th>
      <th>MSFT</th>
      <th>SPY</th>
      <th>AAPL</th>
      <th>MSFT</th>
      <th>SPY</th>
      <th>AAPL</th>
      <th>MSFT</th>
      <th>SPY</th>
      <th>AAPL</th>
      <th>MSFT</th>
      <th>SPY</th>
      <th>AAPL</th>
      <th>MSFT</th>
      <th>SPY</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-01-03</th>
      <td>26.952709</td>
      <td>56.930573</td>
      <td>198.560028</td>
      <td>29.037500</td>
      <td>62.580002</td>
      <td>225.240005</td>
      <td>29.082500</td>
      <td>62.840000</td>
      <td>225.830002</td>
      <td>28.690001</td>
      <td>62.130001</td>
      <td>223.880005</td>
      <td>28.950001</td>
      <td>62.790001</td>
      <td>225.039993</td>
      <td>115127600</td>
      <td>20694100</td>
      <td>91366500</td>
    </tr>
    <tr>
      <th>2017-01-04</th>
      <td>26.922539</td>
      <td>56.675846</td>
      <td>199.741318</td>
      <td>29.004999</td>
      <td>62.299999</td>
      <td>226.580002</td>
      <td>29.127501</td>
      <td>62.750000</td>
      <td>226.750000</td>
      <td>28.937500</td>
      <td>62.119999</td>
      <td>225.610001</td>
      <td>28.962500</td>
      <td>62.480000</td>
      <td>225.619995</td>
      <td>84472400</td>
      <td>21340000</td>
      <td>78744400</td>
    </tr>
    <tr>
      <th>2017-01-05</th>
      <td>27.059454</td>
      <td>56.675846</td>
      <td>199.582642</td>
      <td>29.152500</td>
      <td>62.299999</td>
      <td>226.399994</td>
      <td>29.215000</td>
      <td>62.660000</td>
      <td>226.580002</td>
      <td>28.952499</td>
      <td>62.029999</td>
      <td>225.479996</td>
      <td>28.980000</td>
      <td>62.189999</td>
      <td>226.270004</td>
      <td>88774400</td>
      <td>24876000</td>
      <td>78379000</td>
    </tr>
    <tr>
      <th>2017-01-06</th>
      <td>27.361116</td>
      <td>57.167103</td>
      <td>200.296692</td>
      <td>29.477501</td>
      <td>62.840000</td>
      <td>227.210007</td>
      <td>29.540001</td>
      <td>63.150002</td>
      <td>227.750000</td>
      <td>29.117500</td>
      <td>62.040001</td>
      <td>225.899994</td>
      <td>29.195000</td>
      <td>62.299999</td>
      <td>226.529999</td>
      <td>127007600</td>
      <td>19922900</td>
      <td>71559900</td>
    </tr>
    <tr>
      <th>2017-01-09</th>
      <td>27.611729</td>
      <td>56.985142</td>
      <td>199.635544</td>
      <td>29.747499</td>
      <td>62.639999</td>
      <td>226.460007</td>
      <td>29.857500</td>
      <td>63.080002</td>
      <td>227.070007</td>
      <td>29.485001</td>
      <td>62.540001</td>
      <td>226.419998</td>
      <td>29.487499</td>
      <td>62.759998</td>
      <td>226.910004</td>
      <td>134247600</td>
      <td>20382700</td>
      <td>46939700</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2017-04-24</th>
      <td>33.476299</td>
      <td>61.806141</td>
      <td>209.986496</td>
      <td>35.910000</td>
      <td>67.529999</td>
      <td>237.169998</td>
      <td>35.987499</td>
      <td>67.660004</td>
      <td>237.410004</td>
      <td>35.794998</td>
      <td>67.099998</td>
      <td>234.559998</td>
      <td>35.875000</td>
      <td>67.480003</td>
      <td>237.179993</td>
      <td>68537200</td>
      <td>29770000</td>
      <td>119209900</td>
    </tr>
    <tr>
      <th>2017-04-25</th>
      <td>33.683723</td>
      <td>62.163101</td>
      <td>211.208313</td>
      <td>36.132500</td>
      <td>67.919998</td>
      <td>238.550003</td>
      <td>36.224998</td>
      <td>68.040001</td>
      <td>238.949997</td>
      <td>35.967499</td>
      <td>67.599998</td>
      <td>237.809998</td>
      <td>35.977501</td>
      <td>67.900002</td>
      <td>237.910004</td>
      <td>75486000</td>
      <td>30242700</td>
      <td>76698300</td>
    </tr>
    <tr>
      <th>2017-04-26</th>
      <td>33.485615</td>
      <td>62.080727</td>
      <td>211.075531</td>
      <td>35.919998</td>
      <td>67.830002</td>
      <td>238.399994</td>
      <td>36.150002</td>
      <td>68.309998</td>
      <td>239.529999</td>
      <td>35.845001</td>
      <td>67.620003</td>
      <td>238.350006</td>
      <td>36.117500</td>
      <td>68.080002</td>
      <td>238.509995</td>
      <td>80164800</td>
      <td>26190800</td>
      <td>84702500</td>
    </tr>
    <tr>
      <th>2017-04-27</th>
      <td>33.511253</td>
      <td>62.483425</td>
      <td>211.252609</td>
      <td>35.947498</td>
      <td>68.269997</td>
      <td>238.600006</td>
      <td>36.040001</td>
      <td>68.379997</td>
      <td>238.949997</td>
      <td>35.827499</td>
      <td>67.580002</td>
      <td>237.979996</td>
      <td>35.980000</td>
      <td>68.150002</td>
      <td>238.770004</td>
      <td>56985200</td>
      <td>34971000</td>
      <td>57410300</td>
    </tr>
    <tr>
      <th>2017-04-28</th>
      <td>33.478619</td>
      <td>62.657314</td>
      <td>210.792191</td>
      <td>35.912498</td>
      <td>68.459999</td>
      <td>238.080002</td>
      <td>36.075001</td>
      <td>69.139999</td>
      <td>238.929993</td>
      <td>35.817501</td>
      <td>67.690002</td>
      <td>237.929993</td>
      <td>36.022499</td>
      <td>68.910004</td>
      <td>238.899994</td>
      <td>83441600</td>
      <td>39548800</td>
      <td>63532800</td>
    </tr>
  </tbody>
</table>
<p>81 rows √ó 18 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Ticker</th>
      <th>AAPL</th>
      <th>MSFT</th>
      <th>SPY</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-01-03</th>
      <td>26.952709</td>
      <td>56.930573</td>
      <td>198.560028</td>
    </tr>
    <tr>
      <th>2017-01-04</th>
      <td>26.922539</td>
      <td>56.675846</td>
      <td>199.741318</td>
    </tr>
    <tr>
      <th>2017-01-05</th>
      <td>27.059454</td>
      <td>56.675846</td>
      <td>199.582642</td>
    </tr>
    <tr>
      <th>2017-01-06</th>
      <td>27.361116</td>
      <td>57.167103</td>
      <td>200.296692</td>
    </tr>
    <tr>
      <th>2017-01-09</th>
      <td>27.611729</td>
      <td>56.985142</td>
      <td>199.635544</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2017-04-24</th>
      <td>33.476299</td>
      <td>61.806141</td>
      <td>209.986496</td>
    </tr>
    <tr>
      <th>2017-04-25</th>
      <td>33.683723</td>
      <td>62.163101</td>
      <td>211.208313</td>
    </tr>
    <tr>
      <th>2017-04-26</th>
      <td>33.485615</td>
      <td>62.080727</td>
      <td>211.075531</td>
    </tr>
    <tr>
      <th>2017-04-27</th>
      <td>33.511253</td>
      <td>62.483425</td>
      <td>211.252609</td>
    </tr>
    <tr>
      <th>2017-04-28</th>
      <td>33.478619</td>
      <td>62.657314</td>
      <td>210.792191</td>
    </tr>
  </tbody>
</table>
<p>81 rows √ó 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tickers</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;AAPL&#39;</span><span class="p">,</span><span class="s1">&#39;ABBV&#39;</span><span class="p">,</span><span class="s1">&#39;ABT&#39;</span><span class="p">,</span><span class="s1">&#39;ACN&#39;</span><span class="p">,</span><span class="s1">&#39;ADP&#39;</span><span class="p">,</span><span class="s1">&#39;ADSK&#39;</span><span class="p">,</span><span class="s1">&#39;AES&#39;</span><span class="p">,</span><span class="s1">&#39;AET&#39;</span><span class="p">,</span><span class="s1">&#39;AFL&#39;</span><span class="p">,</span><span class="s1">&#39;AMAT&#39;</span><span class="p">,</span><span class="s1">&#39;AMGN&#39;</span><span class="p">,</span><span class="s1">&#39;AMZN&#39;</span><span class="p">,</span><span class="s1">&#39;APA&#39;</span><span class="p">,</span>
    <span class="s1">&#39;APHA&#39;</span><span class="p">,</span><span class="s1">&#39;APD&#39;</span><span class="p">,</span><span class="s1">&#39;APTV&#39;</span><span class="p">,</span><span class="s1">&#39;ARE&#39;</span><span class="p">,</span><span class="s1">&#39;ASML&#39;</span><span class="p">,</span><span class="s1">&#39;ATVI&#39;</span><span class="p">,</span><span class="s1">&#39;AXP&#39;</span><span class="p">,</span><span class="s1">&#39;BA&#39;</span><span class="p">,</span><span class="s1">&#39;BAC&#39;</span><span class="p">,</span><span class="s1">&#39;BAX&#39;</span><span class="p">,</span><span class="s1">&#39;BDX&#39;</span><span class="p">,</span><span class="s1">&#39;BIIB&#39;</span><span class="p">,</span><span class="s1">&#39;BK&#39;</span><span class="p">,</span>
    <span class="s1">&#39;BKNG&#39;</span><span class="p">,</span><span class="s1">&#39;BMY&#39;</span><span class="p">,</span><span class="s1">&#39;BRKB&#39;</span><span class="p">,</span><span class="s1">&#39;BRK.A&#39;</span><span class="p">,</span><span class="s1">&#39;COG&#39;</span><span class="p">,</span><span class="s1">&#39;COST&#39;</span><span class="p">,</span><span class="s1">&#39;CPB&#39;</span><span class="p">,</span><span class="s1">&#39;CRM&#39;</span><span class="p">,</span><span class="s1">&#39;CSCO&#39;</span><span class="p">,</span><span class="s1">&#39;CVS&#39;</span><span class="p">,</span><span class="s1">&#39;DAL&#39;</span><span class="p">,</span><span class="s1">&#39;DD&#39;</span><span class="p">,</span><span class="s1">&#39;DHR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;DIS&#39;</span><span class="p">,</span><span class="s1">&#39;DOW&#39;</span><span class="p">,</span><span class="s1">&#39;DUK&#39;</span><span class="p">,</span><span class="s1">&#39;EMR&#39;</span><span class="p">,</span><span class="s1">&#39;EPD&#39;</span><span class="p">,</span><span class="s1">&#39;EQT&#39;</span><span class="p">,</span><span class="s1">&#39;ESRT&#39;</span><span class="p">,</span><span class="s1">&#39;EXPD&#39;</span><span class="p">,</span><span class="s1">&#39;FFIV&#39;</span><span class="p">,</span><span class="s1">&#39;FLS&#39;</span><span class="p">,</span><span class="s1">&#39;FLT&#39;</span><span class="p">,</span><span class="s1">&#39;FRT&#39;</span><span class="p">,</span><span class="s1">&#39;GE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;GILD&#39;</span><span class="p">,</span><span class="s1">&#39;GOOGL&#39;</span><span class="p">,</span><span class="s1">&#39;GOOG&#39;</span><span class="p">,</span><span class="s1">&#39;GS&#39;</span><span class="p">,</span><span class="s1">&#39;HAL&#39;</span><span class="p">,</span><span class="s1">&#39;HD&#39;</span><span class="p">,</span><span class="s1">&#39;HON&#39;</span><span class="p">,</span><span class="s1">&#39;IBM&#39;</span><span class="p">,</span><span class="s1">&#39;INTC&#39;</span><span class="p">,</span><span class="s1">&#39;IP&#39;</span><span class="p">,</span><span class="s1">&#39;JNJ&#39;</span><span class="p">,</span><span class="s1">&#39;JPM&#39;</span><span class="p">,</span><span class="s1">&#39;KEY&#39;</span><span class="p">,</span>
    <span class="s1">&#39;KHC&#39;</span><span class="p">,</span><span class="s1">&#39;KIM&#39;</span><span class="p">,</span><span class="s1">&#39;KO&#39;</span><span class="p">,</span><span class="s1">&#39;LLY&#39;</span><span class="p">,</span><span class="s1">&#39;LMT&#39;</span><span class="p">,</span><span class="s1">&#39;LOW&#39;</span><span class="p">,</span><span class="s1">&#39;MCD&#39;</span><span class="p">,</span><span class="s1">&#39;MCHP&#39;</span><span class="p">,</span><span class="s1">&#39;MDT&#39;</span><span class="p">,</span><span class="s1">&#39;MMM&#39;</span><span class="p">,</span><span class="s1">&#39;MO&#39;</span><span class="p">,</span><span class="s1">&#39;MRK&#39;</span><span class="p">,</span><span class="s1">&#39;MSFT&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MTD&#39;</span><span class="p">,</span><span class="s1">&#39;NEE&#39;</span><span class="p">,</span><span class="s1">&#39;NFLX&#39;</span><span class="p">,</span><span class="s1">&#39;NKE&#39;</span><span class="p">,</span><span class="s1">&#39;NOV&#39;</span><span class="p">,</span><span class="s1">&#39;ORCL&#39;</span><span class="p">,</span><span class="s1">&#39;OXY&#39;</span><span class="p">,</span><span class="s1">&#39;PEP&#39;</span><span class="p">,</span><span class="s1">&#39;PFE&#39;</span><span class="p">,</span><span class="s1">&#39;PG&#39;</span><span class="p">,</span><span class="s1">&#39;RTN&#39;</span><span class="p">,</span><span class="s1">&#39;RTX&#39;</span><span class="p">,</span><span class="s1">&#39;SBUX&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SHW&#39;</span><span class="p">,</span><span class="s1">&#39;SLB&#39;</span><span class="p">,</span><span class="s1">&#39;SO&#39;</span><span class="p">,</span><span class="s1">&#39;SPG&#39;</span><span class="p">,</span><span class="s1">&#39;STT&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="s1">&#39;TGT&#39;</span><span class="p">,</span><span class="s1">&#39;TXN&#39;</span><span class="p">,</span><span class="s1">&#39;UNH&#39;</span><span class="p">,</span><span class="s1">&#39;UPS&#39;</span><span class="p">,</span><span class="s1">&#39;USB&#39;</span><span class="p">,</span><span class="s1">&#39;UTX&#39;</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">,</span><span class="s1">&#39;VZ&#39;</span><span class="p">,</span>
    <span class="s1">&#39;WMT&#39;</span><span class="p">,</span><span class="s1">&#39;XOM&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tickers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;AAPL ABBV ABT ACN ADP ADSK AES AET AFL AMAT AMGN AMZN APA APHA APD APTV ARE ASML ATVI AXP BA BAC BAX BDX BIIB BK BKNG BMY BRKB BRK.A COG COST CPB CRM CSCO CVS DAL DD DHR DIS DOW DUK EMR EPD EQT ESRT EXPD FFIV FLS FLT FRT GE GILD GOOGL GOOG GS HAL HD HON IBM INTC IP JNJ JPM KEY KHC KIM KO LLY LMT LOW MCD MCHP MDT MMM MO MRK MSFT MTD NEE NFLX NKE NOV ORCL OXY PEP PFE PG RTN RTX SBUX SHW SLB SO SPG STT T TGT TXN UNH UPS USB UTX V VZ WMT XOM&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tickers</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="s2">&quot;1980-01-01&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2023-08-01&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[                       0%%                      ]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[*                      2%%                      ]  2 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[*                      3%%                      ]  3 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**                     4%%                      ]  4 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**                     5%%                      ]  5 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**                     5%%                      ]  5 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[***                    7%%                      ]  7 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[***                    7%%                      ]  8 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[****                   8%%                      ]  9 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[****                   9%%                      ]  10 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[*****                 10%%                      ]  11 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[*****                 11%%                      ]  12 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[******                12%%                      ]  13 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[******                13%%                      ]  14 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[*******               14%%                      ]  15 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[*******               15%%                      ]  16 of 107 completed
[*******               15%%                      ]  16 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[********              17%%                      ]  18 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[*********             18%%                      ]  19 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[*********             19%%                      ]  20 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********            20%%                      ]  21 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********            21%%                      ]  22 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********            21%%                      ]  23 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[***********           22%%                      ]  24 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[***********           23%%                      ]  25 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[************          24%%                      ]  26 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[************          25%%                      ]  27 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[************          26%%                      ]  28 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[*************         27%%                      ]  29 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[*************         28%%                      ]  30 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**************        29%%                      ]  31 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**************        30%%                      ]  32 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[***************       31%%                      ]  33 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[***************       32%%                      ]  34 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[****************      33%%                      ]  35 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[****************      34%%                      ]  36 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[*****************     35%%                      ]  37 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[*****************     36%%                      ]  38 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[*****************     36%%                      ]  39 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[******************    37%%                      ]  40 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[******************    38%%                      ]  41 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[*******************   39%%                      ]  42 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[*******************   40%%                      ]  43 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[********************  41%%                      ]  44 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[********************  42%%                      ]  45 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[********************* 43%%                      ]  46 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[********************* 44%%                      ]  47 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************45%%                      ]  48 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************46%%                      ]  49 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************47%%                      ]  50 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************48%%                      ]  51 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************49%%                      ]  52 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************50%%                      ]  53 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************50%%                      ]  54 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************51%%                      ]  55 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************52%%                      ]  56 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************53%%                      ]  57 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************54%%                      ]  58 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************55%%                      ]  59 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************56%%*                     ]  60 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************57%%*                     ]  61 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************58%%**                    ]  62 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************59%%**                    ]  63 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************59%%**                    ]  63 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************61%%***                   ]  65 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************62%%****                  ]  66 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************63%%****                  ]  67 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************64%%*****                 ]  68 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************64%%*****                 ]  69 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************65%%*****                 ]  70 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************66%%******                ]  71 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************67%%******                ]  72 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************68%%*******               ]  73 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************69%%*******               ]  74 of 107 completed
[**********************69%%*******               ]  74 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************71%%********              ]  76 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************72%%*********             ]  77 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************73%%*********             ]  78 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************74%%**********            ]  79 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************75%%**********            ]  80 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************76%%**********            ]  81 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************77%%***********           ]  82 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************78%%***********           ]  83 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************79%%************          ]  84 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************79%%************          ]  85 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************80%%************          ]  86 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************81%%*************         ]  87 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************82%%*************         ]  88 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************82%%*************         ]  88 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************84%%**************        ]  90 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************85%%***************       ]  91 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************86%%***************       ]  92 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************87%%****************      ]  93 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************88%%****************      ]  94 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************89%%*****************     ]  95 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************90%%*****************     ]  96 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************91%%******************    ]  97 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************92%%******************    ]  98 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************93%%*******************   ]  99 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************93%%*******************   ]  99 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************94%%*******************   ]  101 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************95%%********************  ]  102 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************96%%********************  ]  103 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************97%%********************* ]  104 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************98%%********************* ]  105 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[**********************99%%**********************]  106 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[*********************100%%**********************]  107 of 107 completed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8 Failed downloads:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;APHA&#39;, &#39;ATVI&#39;, &#39;RTN&#39;, &#39;FLT&#39;, &#39;UTX&#39;, &#39;COG&#39;, &#39;BRK.A&#39;, &#39;BRKB&#39;]: YFTzMissingError(&#39;$%ticker%: possibly delisted; No timezone found&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">][</span><span class="s1">&#39;AAPL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;Date&#39;&gt;
</pre></div>
</div>
<img alt="../_images/763ce0d41d1759d358d444cd3a46dcbcfd6933d4c6b724a21f667a15e391c343.png" src="../_images/763ce0d41d1759d358d444cd3a46dcbcfd6933d4c6b724a21f667a15e391c343.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cols_with_many_nas</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;BRK.A&quot;</span><span class="p">,</span>
    <span class="s2">&quot;APHA&quot;</span><span class="p">,</span>
    <span class="s2">&quot;UTX&quot;</span><span class="p">,</span>
    <span class="s2">&quot;RTN&quot;</span><span class="p">,</span>
    <span class="s2">&quot;COG&quot;</span><span class="p">,</span>
    <span class="s2">&quot;BRKB&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ATVI&quot;</span><span class="p">,</span>
    <span class="s2">&quot;FLT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;DOW&quot;</span><span class="p">,</span>
    <span class="s2">&quot;KHC&quot;</span><span class="p">,</span>
    <span class="s2">&quot;V&quot;</span><span class="p">,</span>
    <span class="s2">&quot;APTV&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ABBV&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ESRT&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">cols_with_many_nas</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;AAPL&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;Date&#39;&gt;
</pre></div>
</div>
<img alt="../_images/27de54a15ebbbc371638b23bd59da644c266452dc4234727419900a12c097719.png" src="../_images/27de54a15ebbbc371638b23bd59da644c266452dc4234727419900a12c097719.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pc1</span><span class="p">,</span> <span class="n">loadings</span> <span class="o">=</span> <span class="n">pca</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s1">&#39;scikitlearn&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pc1</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;Date&#39;&gt;
</pre></div>
</div>
<img alt="../_images/2c59dbd57a84228ddb26865aafc62fe67ddebdf8578086b7d97d7c6eb104e842.png" src="../_images/2c59dbd57a84228ddb26865aafc62fe67ddebdf8578086b7d97d7c6eb104e842.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pc1</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;Date&#39;&gt;
</pre></div>
</div>
<img alt="../_images/df9baca8bc92613ad5a717a5cc7fde232ed86b10a042670075bb6698f689c8d4.png" src="../_images/df9baca8bc92613ad5a717a5cc7fde232ed86b10a042670075bb6698f689c8d4.png" />
</div>
</div>
<ul class="simple">
<li><p>Why does this plot only go back to 2019? What happened?</p></li>
<li><p>What are methods that we might use to deal with missing data?</p></li>
</ul>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="_03_04-Missing-Values.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">3.4 Handling Missing Data</p>
      </div>
    </a>
    <a class="right-next"
       href="../WRDS_intro_and_web_queries.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">3.6 Introduction to WRDS</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-macroeconomic-and-financial-data-from-fred">Downloading macroeconomic and financial data from FRED</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cleaning-data">Cleaning Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transforming-and-normalizing-the-data">Transforming and Normalizing the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factor-analysis-of-a-panel-of-stock-returns">Factor Analysis of a Panel of Stock Returns?</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jeremiah Bejarano
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2024, Jeremiah Bejarano.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>